document.addEventListener('DOMContentLoaded', () => {
    // Obtém o elemento do formulário
    const form = document.getElementById('notaForm');
    
    // Adiciona o listener para quando o formulário é submetido
    form.addEventListener('submit', (event) => {
        event.preventDefault(); // Impede o envio padrão do formulário

        // O elemento que será convertido em PDF (neste caso, o próprio formulário)
        const input = document.getElementById('notaForm');

        // Configurações e chamada do html2canvas
        // scale: 2 é usado para melhorar a qualidade da imagem
        html2canvas(input, { scale: 2 }).then(canvas => {
            
            // Instancia o objeto jsPDF usando a sintaxe de carregamento do CDN
            // 'p' = portrait (vertical), 'mm' = milímetros, 'a4' = tamanho do papel
            const doc = new window.jspdf.jsPDF('p', 'mm', 'a4'); 

            // Converte o canvas (imagem do formulário) para um formato de dados
            const imgData = canvas.toDataURL('image/png');
            
            // Adiciona a imagem ao documento PDF
            // (0, 0) são as coordenadas iniciais, e (210, 297) é o tamanho A4 em mm
            doc.addImage(imgData, 'PNG', 0, 0, 210, 297); 

            // Salva o ficheiro PDF
            doc.save('nota_oficial.pdf');
        });
    });
});
